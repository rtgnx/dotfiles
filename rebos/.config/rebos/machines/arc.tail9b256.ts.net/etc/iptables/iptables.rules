*filter

# Accept everything on loopback
-A INPUT -i lo -j ACCEPT

# Accept established/related connections
-A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT

# Accept SSH (adjust port if not 22)
-A INPUT -p tcp --dport 22 -j ACCEPT

# Accept ICMP (ping)
-A INPUT -p icmp -j ACCEPT

# Drop invalid packets
-A INPUT -m state --state INVALID -j DROP

# HTTP/HTTPS traffic
-A INPUT -p tcp --dport 80 -j ACCEPT
-A INPUT -p tcp --dport 443 -j ACCEPT

# Drop everything else
-A INPUT -j DROP

# Forwarding (if any)
-A FORWARD -j DROP

# Allow all outgoing
-A OUTPUT -j ACCEPT

COMMIT
